<h1><%= @list.name %></h1>

<%= link_to "Back to lists", lists_path, class: "pull-right" %>

<div class="btn-group">
  <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Options
  </button>
  <div class="dropdown-menu">
    <button class="dropdown-item" type="button"><%= link_to "Edit", edit_list_path(@list) %></button>
    <button class="dropdown-item" type="button"><%= link_to "Destroy", list_path(@list), method: :delete, data: { confirm: "Are you sure?" } %></button>
    <button class="dropdown-item" type="button">Created: <%= @list.created_at.to_formatted_s(:long) %></button>
    <button class="dropdown-item" type="button">Last updated: <%= @list.last_item_update %></button>
  </div>
</div>

<br /><br />
<%= link_to "Share list", new_users_list_path(list_id: params[:id]), class: "btn btn-primary btn-block" %>
<br />

<%= link_to "Add item to list", new_item_path(list_id: params[:id]), class: "btn btn-success btn-block" %>
<br />

<h2>Items</h2>

<div id="item-accordion" role="tablist" aria-multiselectable="true">
  <% @list.items.not_purchased.each_with_index do |item, index| %>
    <div class="card">
      <a data-toggle="collapse" data-parent="#accordion" href="#collapse<%= index %>" aria-expanded="true" aria-controls="collapse<%= index %>">
        <div class="card-header" role="tab" id="heading<%= index %>">
          <p class="mb-0"><%= item.quantity %> <%= item.quantity_name %> <%= item.name %></p>
        </div>
      </a>

      <div id="collapse<%= index %>" class="collapse" role="tabpanel" aria-labelledby="heading<%= index %>">
        <div class="card-block">
          <%= link_to "Purchased", item_path(item, item: { purchased: true }, list_id: params[:id]), method: :put, class: "btn btn-primary btn-sm", style: "margin-right: 1rem;" %>
          <%= link_to "Edit", edit_item_path(item, list_id: params[:id]), class: "btn btn-secondary btn-sm", style: "margin-right: 1rem;" %>
          <%= link_to "Destroy", item_path(item, list_id: params[:id]), method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-danger btn-sm" %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<br />

<h2>Purchased</h2>

<ul class="list-group">
  <% @list.items.purchased.each do |item| %>
    <li class="list-group-item"><%= item.quantity %> <%= item.name %></li>
  <% end %>
</ul>
